var myWindow = new Window("palette", "", undefined, {
    closeButton: false,
    borderless: true
});
myWindow.margins = 0;
myWindow.spacing = 0;
myWindow.size = [180, 300];
borderGroup = myWindow.add("group");
borderGroup.alignChildren = ["fill", "fill"];
borderGroup.margins = 10;
borderGroup.orientation = "row";
var icon_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%7C%00%00%00%10%08%06%00%00%00%C3%94(%1B%C2%9F%00%00%00%09pHYs%00%00%0B%12%00%00%0B%12%01%C3%92%C3%9D~%C3%BC%00%00%0E%2BIDATX%C2%85%C2%84%C3%8E%3B%0A%C3%82P%10%05%C3%90%C3%B3J%C3%81%C2%BF%16%C2%8A)t%03%C3%AE%7F%2F%C2%B6%1A%14%C3%81B%C3%94%C3%A0%07%C2%9E%04R%C2%84%14%C2%99%0B%C3%93%5C%C3%8E0%C2%93%C2%B0%C3%97%C2%9FG3%C2%AB%C3%80%3Dq%C3%87%3Ap%15n%C3%98%04%C3%AE%C2%8D%2B%C2%8A%C3%80%7Dp%C3%82%16%C2%A9%C3%A9%5E%C2%B8t%C2%BA*%C3%A7%7C%C3%A8.%C2%A7%C2%94v%18%C2%B6%5C%3B%19_%1C%C2%B1%C3%84(p%C3%B5%1Fs%C2%8C%03Wb%C2%82i%C2%8F%C3%BB5%C2%AE%C2%BE9%0B%C3%9C%19%03%2Cz%C3%AFR%C3%BE%01%00%00%C3%BF%C3%BFbIM%C2%88%C2%BB%C2%885%18%C2%A1%C3%A0%C3%9C%C2%85%C2%8B%C2%BF%C2%9F%3E%7F%C3%B1%C3%91%C3%97%C3%93%5D%04%C2%9F%C2%BA%C2%8BW%C2%AE%C3%BEy%C3%B0%C3%B0%C3%91%7B%7FoOQ%7C%C3%AA._%C2%BB%C3%BE%C3%B7%C3%B6%C2%9D%C2%BBo%C2%83%C3%BC%7C%C3%84%1E%3E~%C3%82%20%2F%C2%8B%3D%3E%C2%AF%C3%9D%C2%B8%C3%B9%C3%AF%C3%8A%C2%B5%C3%AB%C2%AF%C3%83%C2%82%02%C3%84%C3%B1%C2%99w%C3%AB%C3%8E%C3%9D%C3%BFg%C3%8E%C2%9F%7F%15%15%1A%02Ww%C3%A7%C3%9E%C3%BD%C3%BF'%C3%8F%C2%9C%7D%19%15%1A%22%C3%81%08%C3%B5%C3%BE%C2%BD%07%0F%C3%BF322%3A%C3%BE%C3%BF%C3%BF%C3%BF%20L%1D%C2%88%C3%AF%C3%AA%C3%A4%C2%B8WAN%16%5B%20%C3%81%C3%81%C2%92%C2%95%C2%ABoZ%C2%99%C2%9B%C2%A9))%C3%88%C3%A3U%C2%B7%7C%C3%B5%C3%9A%7B%C3%86%C2%86%06%C2%8Aj*%C3%8Ax%C3%95%C2%ADZ%C2%B7%C3%A1%C2%81%C2%8E%C2%96%C2%A6%C2%9C%C2%96%C2%86%3A%13%3Eu%C3%AB6m%C2%B9%C2%AD%C2%A2%C2%AC%C2%A4%C2%AC%C2%A7%C2%AD%C2%85W%C3%9D%C2%A6m%C3%9B%2F%C3%88%C3%8B%C3%8A%C3%AA%C3%AA%C3%AB%C3%AA0c%C2%93%C2%BF%C3%B7%C3%A0!%C2%83%C2%92%C2%82%3C%C3%83%C2%8A5%C3%AB6%03%00%00%00%C3%BF%C3%BFb%C3%B1tu%C3%81g%16%C3%83%C2%A7%C3%8F_X%C2%BF%C3%BF%C3%B8)BH%C3%9D%C2%8F%C2%9F%3FY%3E%7C%C3%BC(JH%C3%9D%C2%9F%C2%BF%7F%C2%99_%C2%BE%7C%25%06Rw%C3%B4%C3%A4)%06ks3%C2%AC%C3%AA%18%19%C2%99%C2%98%C3%AE%3F%7C(N%C3%88%3C%0E%0E%0E%C3%86%2B%C3%97%C2%AE%C2%8B%7B%C2%B8%C2%BA%C3%80%C2%93%C3%B6%C3%A1c%C3%87%19%2F%5C%C2%BE%22%C3%A1%C3%A9%C2%86%10%3Bv%C3%B2%14%C3%A3%C3%9E%03%07A%C2%B9%05%19%C2%B0%1B%19%C3%A83%C2%9A%1B%1B%C3%A1%C2%B5c%C3%B5%C2%86M%C3%9C%06z%C2%BA%C2%8C%C2%B8%C3%9C%0A%03%C3%AB7o%C3%A5%C3%96%C3%93%C3%91ft%C2%B4%C2%B5%C3%81%C2%ABn%C3%AB%C2%8E%5D%C3%9C%C3%9A%C2%9A%1AL%1E.%C3%8Ex%C3%95%C3%AD9p%C2%90SSM%C2%8D%C2%89P%18%1C%3Az%C2%9CW%5DM%C2%95%19%C2%AB%3AFF%C2%86%17%2F_1H%C2%88%C2%892l%C3%9C%C2%BA%C2%9D%03%00%00%00%C3%BF%C3%BFl%C2%94I%0E%C3%820%0CE%C2%BF%C3%AD%C3%86%C2%99*%C3%A0%C3%BEWD%C2%B0%C2%81VEA%14%25%1D%C2%A1%C3%89*%C3%83%C2%8B%C2%87o%C3%8B%0D%C3%B3%C3%94%14%C3%8C%C2%8C%10%C3%A3%C2%81%C2%B7%C3%96%C3%A6%3F%C3%988B%C2%88m%C2%85s%20%C3%90%C3%8A9%C3%AF1%C2%8E%1F%C2%BCS%C2%82%0F%11%C3%9D%C3%B3%C2%81q%04%C2%98%08%2C%C2%82%C3%93%C3%B9%02%C3%AB%1CD%04%C2%8DQ%18c%C3%90w%C3%9D.N*%C3%93i%C2%B1%C2%97%C2%8F%C2%B1%C3%BD%C2%AF%C3%97%C3%A4'WU%C2%98%C3%97iF%C3%8Ce%C2%B7%C3%9C%195p!T%C3%85*%C3%B1%C3%8C%3Er%C2%AEF%C2%B5%C2%A2%19%C3%BDpj-%C2%B4%C3%86q%C3%A6x%C3%87)Tm%C2%85%C3%A3%C3%9C%C3%90%1B%C2%A7Zl%1Ebc%C2%99l%C3%8E%5C%C3%8E%23%C3%AB%C3%BC%C2%BFD%C2%84%C3%94%C2%BA%C2%A2%C3%A9%C3%B5v%C2%87W%C2%B3%22%C3%BD0%C3%A0%C2%95Ry%23%22%7C%01%00%00%C3%BF%C3%BFl%C2%93%3FK%C3%83%40%18%C3%86%1Fs%C2%8A%06%C2%93%C3%8Cu%2B.%C3%85%C2%AF%20%C2%82%1F%C3%81%C2%B1%C2%B8%09~%027%C3%85%C2%A9%C3%94.%C2%8A%C2%9BP%22%C2%9A%061%C2%82E%1C%C2%AAb%C2%9C%C2%84%10A%C3%BA%09*%C2%A5%C2%A3(%01%3B5%C2%B9%C2%8B%09%17%C2%B9%C2%B3%1D%C3%8A%C3%B5%C3%86%C3%A3%C3%B7%C3%BEy%C3%9E%C3%A7%7D%C3%A7%C3%BF%C2%87%02%7C~%7Fao%C3%BFPI%C2%96e%19%C3%96*%15%18%C2%96%C2%85_%C3%86%10E%11%C2%AA%3B%C2%BB%0A%C2%97%C3%A79V%C3%8BeL%C3%B25%C2%8EO%C2%B0R*%C3%89%0B%3E%C2%A8%C3%95%C3%A16%C3%8F%C2%A0%2F%C3%A9Rh%1C%C2%8F%10%C2%84!%16%08AQ%14x%C3%B2%7D%C2%B1%C3%8D8%3D%C2%AAO%19%C2%81%C2%B1ib%18%19%C3%A7%C3%98%C2%AAn%C2%83s%C2%AE%C3%94%C2%B5%2Cs%C3%8A%C3%B0I%C2%AC%26%C2%8D%C2%9F%C3%83%C3%B0g%C2%88%5E%C3%AFC%C3%A9Y%C2%BCE%5D%C3%87%C2%B2a%C2%80%C3%91%04%C2%ADk%0F%0F%C3%8F%C2%BE%C3%82PJe%C3%9F%C2%A2%C3%86(I%C3%90tZ%08%C3%827%C2%85c%C2%8CI%C2%83%04%17S%C2%8As%C3%B7%0A%C2%AFA0%C2%93%13%C2%9A%0C%C3%93%04Mb%C3%9Cw%3A%C3%B0%C3%9Aw3%C2%B9%C3%8D%C2%8Du%10%C2%A2%C3%89%C2%A3y%C3%B4_%60_%3A%0A%C2%97%C2%A6%C2%A9%C3%96%1F%0Cps%C3%9B%C2%96%C2%9A%C2%BD%0B%1Bd%C2%BC%24%C3%AF%C3%9D.l%C3%87%C2%95%C3%BF%C2%8C1%C3%AD%0F%00%00%C3%BF%C3%BFlV%C3%8BJ%C3%83P%10%3Di%C3%94%C3%9A%C3%B4%C2%85-B)%C2%AE%0AZ%22%16%7CT%C2%89%C2%A2.%C3%9Ch%C2%84*%C3%A2%7FhW%C3%BA%13%C2%82%C2%8BZT%C3%BC%16%C3%81E%0C%C2%A6%5D%0AJRl%C2%AAX%C2%8D%C2%BA%2F%0Db%223%7D%C2%80%C3%92Y%C3%9E%7B%C3%AE%C3%9C%C2%999g%C3%A6%C3%9E!rF6%C2%9EH%C2%A2%C2%A0na%3A%3B%C3%B5%C3%87%C3%99%C2%8Dv%0B%C3%BB%C3%B9%05%C2%BA%C2%AE3%C2%A1%C3%B1x%0C%C3%87%C3%85%03%C3%9E%7B4-%C3%88%5D%C2%BCvg%C3%A0%C2%B5%C3%99D%C3%8F%C3%9F%C3%BEN%01%C3%B7%C2%A6%C2%85kM%C3%87Q%C3%B1%10!%C3%AE%C3%A6%00%C2%ABL%C2%92%24(%C3%B9%C2%85%C3%BE%1D%C3%A9T%0As%C2%B9%5C%C3%A7%C2%AC%20%C3%80%17%02%10D%C2%B1%C3%93%C2%A5b%00O%C3%B5%3A%C3%9E%1D%07%C2%ADV%C2%8B%05%C3%B2%C3%9Fx%C2%B2%C2%90x%3C%1FV%C2%A3%C2%81%C3%AF%1F%0Fk%2B%0A'M%C3%9C'%13c%C2%98%C3%8Cd%06%12n%C2%9A%26F%C2%87G0%23g%C2%B1%C2%B1%C2%BE%C3%8A%C3%B9%C2%B7%C3%9B.%C3%9E%1C%C2%87%C3%9F%3D%C2%B2%C2%93%C3%92%19O6%C2%8A%25%16%09co%5B%C3%85r7%C3%BE%C2%A6%C3%B3%C3%81k%C3%91H%04%C2%A7%C3%A5s%16%1B%C3%A1%C2%A2a%09%C2%BB%C3%AA%26%C2%96%C3%A6g%19%C3%A7%7C~!%14%0Cr%C3%BDJ%C2%97W%C2%B0m%1BF%C2%B5%C2%8A%C2%9C%2CCY%C3%8Cc%22%C2%9Df%C3%9C%C2%83i%C3%B59%C2%B8%20%C2%A2%C2%A8%1E%C2%9E%07%C2%A3RA%C2%ADVc%C3%B1%0D0%C2%9F%1A%C2%81%C2%9A%C2%93%26%25%09%C2%AE%C3%87%03%C3%95%C3%84u%C3%A9%C3%BF%0B%00%C3%80%2F%00%00%00%C3%BF%C3%BFba%C2%82%C3%A6Hn%C2%90%03%C2%BD%3C%C3%81%C2%81%C2%83%0C%C3%AE%C3%9C%C2%BB%C3%8F%C3%B0%C3%A6%C3%AD%3B%063%C2%A4z%0E%C3%A4%40%06h%0E%C2%82%C2%89%3Fz%C3%B2%C2%94%C3%A1%C3%89%C3%93g%0C0%C3%B3%24%25%C3%84%19%0A%2B%C2%AB%C3%81%11%24%23.%06v%08%034%C3%B7A%C2%8A~D%3B%C3%84%C3%84%C3%90%00%C2%8CA%C3%A0%C3%A4%C3%99%C3%B3%0C%7B%C3%B7%C3%AFgx%C3%B6%C3%A2%25%C2%B8%C3%A8caa%01%07%C2%BC%C2%B4%24%C3%BE%C3%86%3F8%C2%87310h%C2%A9(%C2%831%03%C2%83%23%C2%8A%3C(%C3%A7a%03%C2%AA%C3%8A%C3%8A%0C%06%C2%BA%C3%9A%60)%05990%C3%BE%C3%BE%C3%BD%07%C3%83%C3%AD%7B%C3%B7%18%C3%B4%C2%B4%C2%B5%C3%80%C3%A2%C2%AC%C2%ACl%C3%90%C2%A2%1A%C3%A2f%05y90%06%C2%81%C2%8BW%C2%AE1%C3%A8%C3%AB%40%C3%94%C2%81%C2%8AfHQ%0DQ'%2F'%0B%C3%86%60uW%C2%AF1%C3%A8C%C3%8D%C2%9B%C2%BDp1%C3%98%1Ec%7DH%07%09%14%C3%99%C2%B0%08%07%C2%A5PXfX%C2%BCb%15%C3%98n%C2%90%C2%B9%C3%86%06%C3%BA%0CO%C2%9F%3D%C3%87%C3%A5%7DP%0B%1C%C2%94%13%C3%80%C2%9E%04U%0107%40%C2%AAF(%60%60%C3%B8%0B%00%00%00%C3%BF%C3%BFbabA%C2%94%C3%B7%C2%A2bb%10%C3%86%C3%BF%C3%BF%0C%C2%8C%C3%BF%C3%BF%C2%81%C3%AB%C3%9C%C3%AF%3F%7F%C2%82S%0B3%3C%C2%82%18%19%C3%BEC%C3%99FFF%0C0%C3%BDL%2C%2C%0CLH%C3%AAX%C2%98Y%18%C2%9C%C3%AC%C3%AC%184%C3%94T%18%C3%98%C3%99%C3%98%C3%A1%C3%A2%C2%A0%3A%1B%C3%A4%18f%C2%A4%08%07%C3%A5h%C2%90G%19%C3%BF%C3%BDe%C2%B025%06%C3%A3-%3Bw3%2C_%C2%B3%C2%96%C3%A1%C3%A7%C2%AF%C3%9F%0C%1Cl%C2%AC%60%7D%20%C3%87c%C3%89%C3%A1%C3%9F%C2%99%C2%98%C2%98~011%09%C3%82%C2%BC%C3%B6%C3%BE%C3%93g%C2%86g%2F_1h%C2%AB*%C3%83%15%C2%B10cm%C3%80%C2%82%C3%85an%C2%81%C2%B9%C2%83%C2%9B%C2%97%C2%95AKK%0B%C3%AE7%C2%90%C2%BD%20%C3%BB%C3%91%C3%95%C2%81%C3%80%C2%8F_%C2%BF%C2%88R%C3%B7%C3%AB%C3%B7%1F4u%C2%880%40Vgl%C2%88%08SP%22%C3%BD%C3%B4%C3%B93%C2%B4j%C2%82%C2%94vX%00%C2%A8%C2%8E%C2%BB%03*(A%C3%9DK%C2%B0%C3%99H%C3%A1%C2%8B%C2%A2%C2%87%C2%81%C3%A15%00%00%00%C3%BF%C3%BFb)%C2%A9%C2%A9%C3%830%23%3A%24%C2%98%C3%81%C3%84%40%1F%C3%8C%C3%A6%C3%A7%C3%A1%01%17%C2%8D%C2%B0%C2%86%C3%83%C3%87O%C2%9F%18%1A%C2%BAz0%C3%B4%C2%BC%7D%C3%BB%C2%96AH%40%00%C2%AC%16%14%25%02%C3%BC%7C%0C%C2%A9%C2%89%C3%B1%0C%C3%AF%3E~bP%C2%94%C2%93%03%C3%A7pPd%C2%81h%C2%B0%07%C2%98%C2%98%18~%C3%BF%C2%83D%C3%9E%C3%91%C3%A3'%18N%C2%9D%3D%C3%8BP%C2%9E%C2%9B%C2%83%12%11%C2%9C%C2%9C%1C%0C%5C%1C%1CP%3E%C2%B8%C3%AE%C3%9E%0Dj%0C%C2%A3Y%C3%BD%C2%8D%C2%89%C2%89)%C2%81%C2%99%C2%89%C3%89%01V%C2%87%C3%9F%C2%BF%C3%BF%C2%80a%C3%8D%C3%A6-%0C%1Du%C3%95%C3%B0z%C2%9D%C2%99%C2%99%05%5B%60%C2%81K%10%C2%98%C3%9F6%C3%AD%C3%98%C3%89%C2%B0%1FK%C3%9D%C3%BC%C3%A5%C3%8B%17%C2%B0%3A%C2%98%C3%9F%C2%B6%C3%AD%C3%99%C3%8B%C2%B0%C3%BB%00%C2%A4w%C3%B7%C3%B5%C3%ABW%C2%86%C2%B5%C2%9B6%C3%83%C3%83%06%C3%A4n%C2%98y%C2%BB%C3%B6%1F%60%C3%98%C2%BEw%1F%C3%84%C2%91%C3%9F%C2%BE1%C2%AC%C3%9E%C2%B0%11%C3%8C~%C3%B3%C3%B6-8C%C3%80%C3%94%C3%AD%3B%7C%C2%84a%C3%B3%C3%8E%5D%18%C3%B6%3E%7B%C3%BE%C2%82AP%C2%80%1F%5E%1F%C2%83%12%13%03%03C%23t%C2%8C%01%06%40%C2%B9%C3%BB%2C%C2%A8%10%C2%81%14%C2%BAL%C3%B3XYYcAa%C3%BC%C3%A7%C3%9F%7F%C2%86%C3%BF%10%C3%BF%C3%AB%C2%80j%2F%06%06%C2%86%C2%BF%00%00%00%00%C3%BF%C3%BFb)%C3%89%C3%8Ed%C3%B8%C3%BA%C3%AD%1B%C2%A8%C3%BB%C3%85%20)%0E%C3%89%C3%A1%C3%82%C2%82%C2%82%C3%B0%14%02%C3%92%08j%C3%A5%3Dz%C3%B1%C2%92A%C2%80%C2%87%C2%9B%C2%81%C2%9F%C2%97%C2%97%01%C2%A4%07%26w%C3%B3%C3%AE%3D%06UE%05%C2%86%1D%7B%C3%B62%5C%C2%BDq%03%C2%A5%C2%A8%C2%BEu%C3%A7.%C3%83%C3%A9%0B%17%18%C3%82%C3%BD%C3%BD%C3%80-qPi%C3%B1%C3%AE%C3%A3Gp%0A%07U%01%C2%A0z%C2%87%C2%83%C2%9D%C2%9D%C3%A1%C3%AB%C2%97%2F%0C%C2%BF%7F%C3%BFax%C3%B5%C3%AE%3D%C2%83%C2%A4%C2%880%C3%84lp%C2%8EF%C2%A4T%2666%C2%86%C3%A9%7D%3D%C2%AE%0C%C3%BF%C3%BF%C2%BB%22%07%C3%8A%C2%893g%19v%C3%AE%C3%9B%C3%BF%17%16(%0C%C3%90V08%C2%80%C2%90%C3%84~%20%C3%95c%C3%88%C3%A0%C3%8D%C2%87%C2%8F%0C%C3%B7%C2%9F%3EcP%C2%91%C2%95ap%C2%B4%C2%B6%C2%82%17%C2%B3%C3%9F%C2%BE%C3%BF%00G%20(L%0A*%C2%AA%C3%BE%C3%83J%26%C2%B0%5B%C2%90%C2%8AI%C3%B4%12%079%C2%87%C2%A3%15%C2%A7(%C3%A0%C3%BD%C3%A7%C3%8F%0Cw%1E%3FaP%C2%97%C2%97c072dP%07WC%C2%90r%19%C3%94fR%C2%92%C2%97c%C2%A8k%C3%AB%C3%B8%0F%C3%B2%03%C3%8C%3C%07kk%06MU%C3%95zt%C2%B3%C2%BA'O%C3%9Dy%C3%BB%C3%AE%5D%0FPn%C3%A7%C3%A4%C3%A4%C3%BC%C3%BF%C3%A0%C3%A93%066VV%06%16%26Fpb%05E%C3%B4%C3%BF%C3%BF%C3%BF%C3%BF0000%00%00%00%00%C3%BF%C3%BFtX%C3%9B%0A%C3%820%0C%3Dnn%C2%A2%20%5B%C2%A7%C2%8E%C3%A9%2C*%C3%AAP%C3%BF%C3%BF%3B%C3%A6%C2%83%C3%A8%C2%838E%C3%B1%C3%B2%01%22%C2%82%0A%C2%93dk%1D%C2%8A%7D%C3%A9CN%C2%9B%13%C2%924M%C3%8A%03)%C2%B1%C3%9A%24%C2%9C%C3%91V%C3%B9%C2%93%05%C2%A5%5C9%19I%1F%C2%AE~%C2%A7%C2%8Du%C2%92%C2%A0%C3%A1%C2%BA%C3%A8K%C3%89%C3%B2%C3%9D%C3%B1%C2%840%08%40wxBd%C3%ADK%C3%BE%C3%BC(%C2%83m%C3%8BF%2F%C3%BC%0C%C3%95%16%C2%9E%C2%97%C2%B79%06%C3%82N%C3%80%19%C2%BC%C3%9D%1F%C2%98%60%C3%A8%C2%B7%C2%B4%5E%C3%930%C3%B4%7D%C2%8A%C3%8F4%C2%8A%C2%B4%5C%C3%AD%C3%87%C3%B3%C2%85pfQo%C3%B1%C2%97%C2%AEV%3Dk9%7F%C3%AAA%C2%BB%C3%99%C3%84%C3%A3~g%2C%05%3A%C3%9BA%7D%7B%3C%C3%87d4%C3%8A2%C3%8C4%C3%93%C3%AB%C3%AD%C3%86%C2%9CX%C3%B7%1FG%C2%92%C3%B3%09%C2%A7%C2%B8%14q%C3%9F%C2%81%C3%91%12%02%C3%A9%C3%AB%C3%89%18%C3%A18p%1D%C2%87%C3%8F%C3%84%C3%8B%15f%C3%91%18%C2%81%C3%AF%C2%A3b%5B%C2%A9*%7FtZ%C3%B1%C3%BB%C3%B6Q%C2%ADV%C3%95%C2%8E%23%C3%BCPv5%07O%C3%900%2F_%00%C3%9E%00%00%00%C3%BF%C3%BFdX%C3%9B%C2%8A%021%0C%3D%C2%B0%C2%8A%C3%85%07%C3%99%05%17%C3%817%C3%99%C3%BF%C3%BF%C2%AA2%C2%A0%03%C3%A3tF%C2%ADN%C2%9A%C2%B4K%C2%A2uW%C3%8CSI%C3%92%C3%8B9M%C2%93%C3%90%C3%99%C2%85%12%C3%86%C3%B3%C3%85%3A%C3%9B%C2%94%C3%93%1B%C2%88%24b%2F1N%C2%84%1B%25D%C3%BA%C3%B3%09%C3%A3%C2%88%C2%9F%C3%9D%0E%C2%BA%06%C2%B1%40r1%7B%1F%C2%82E%3A1C%C2%B2%C2%98%C2%BD%C2%8A%C3%AAr)%18c%C3%84%3A%17%C2%B3i%C2%9D%C3%9A%1F%0E67%0C%C2%83%C2%81W%3F%25Iu%C3%BB%C2%B65%C2%B0%C2%B5%C3%B1%7B0h%C3%BB%C2%93%C3%88%C3%83%C2%8Fp%0C%C2%83%C2%95%C2%95p%3A%C2%A1i%1A%C3%93%C3%95%C2%94%3E%C2%B1%05%C3%B8%C3%9B%C2%85O%C2%89%C3%B1%C2%91%5Eq%C2%A9%C3%8Cgs%2C%C2%96K%C3%93%C3%ABy%C3%9D%C3%82%3Dqt!%C3%80%7B%7F3~RB%C3%9F%C3%B7%3A%14fn%C2%9Cs%C2%9B%C2%BA%C2%96%C2%9E%C3%87%7B%C2%AF%C2%A9%C2%A5%C3%94%0EZ%C3%BD%C2%88%C3%88%13%C3%B3%C3%B7%C2%9DO%C2%B2LVEr%C3%86%C3%AA%C3%B3%C3%8B%C3%B6%C2%95%5C%C2%8A%C3%B20%C3%84%2B%C3%9A%C2%AE%C3%83v%C3%B3%C3%BA%C3%A9x%C3%A7je%C2%BC%C3%BF%0F%2C%C2%9D%5B%C2%83%5D%7B%C2%87%C2%A7%00%C3%B8%05%00%00%C3%BF%C3%BF%7CX1%0A%C2%83%40%10%C3%9Ck%C2%ACD%C2%AD%C3%AC%04O%C3%B1%08%C3%98%08%C2%A9S%C2%87%7C%22%7F%C3%8B%2FR%26u%1E%20%11E%10QA%23z%3E%C3%A0%C3%82*Q%C2%A31%5B%C3%8E%C3%8E%1D%C2%B7%7B%C2%B0%C3%AC%0C%C3%B1%3COl%2CC%7DTU%C3%95%C2%8F%05%C3%934W%C2%B9%C3%B9%C2%B9%C2%BA%C2%AE%C2%A1m%5B%C2%A0%C2%94%C2%8EylD%C3%934%2B%0C%C2%B9%C2%B6%3D-T%C3%88)%C3%8B%12%1C%C3%87%191%C2%BC%0B5%C3%BF%1C%C3%BB%15%C2%9Cs(%C2%8A%02%18%C2%9B%C3%A4d%C3%97u%C2%90%C3%A7%C3%B9%17%C2%865%C2%84ax%12B%C2%8CB%C2%9B%10rd%C2%8C%5DQ%26%C3%BE%C2%AB%C3%8D%C3%B7%C3%BD%C3%980%0C*%C3%8B%C2%83%C3%A1%C2%84%C3%AF%C3%8A%C2%B2%0CG%C3%86R%23%1D%2C%C3%8B%C2%BA%2B%0AZ%C3%A9C%C3%AF%C3%924E%C2%AB%C3%B9%C2%B5%C3%A0%C3%AD)%C2%A5%0FUE%3B%7D%3B%C2%82%20%C2%88u%5D%C2%A7%C2%9A6%C2%98%26%5B%7F%14E%C3%91%C2%8Ds%C3%9E%C3%8B%12I%C2%92.%C2%AE%C3%AB%C2%9E%3F9%C3%ACu%C2%92%24%3B!%C3%84%13%00%C3%A0%0D%00%00%C3%BF%C3%BF%C2%8CXA%0A%00%20%08%C3%B3%C3%BF%3F%0EF%C2%85bPsQ%1E%3A%C3%88t*%C2%99a%5C%03%00WV'YD%C2%8D%C3%A6%20%C2%B2%0B%19%C2%B7%C3%9B%C3%B2%C2%A2%C3%84%C3%84%C3%B3%C2%A6%12Q%C3%BE%5E%C3%B1%C2%BDt%C3%9E%40%C3%95%7C%C3%84%C3%87%C2%8B%C2%85j%02%11Kw%C3%A3%5DrV%C3%BE%C3%A0%5C%17%C2%8B%C2%95%02%3E%C3%AB%C2%A5xe%198'v%1B%C2%A7%C2%99M%00%00%00%C3%BF%C3%BF%7CYA%0A%00%20%08%C3%B3%C3%BF%1F%C3%AE%10I(%09s%C2%B8%3AD%C3%91%C2%B2%C2%B9Y%C2%97%C3%92p6%C2%B2E%02A%C3%8F%C3%A9z!a%C3%84%05%C3%A9%C2%9A%2B301%C3%84%C3%BD%0AHq%C2%9B%C3%B6r%C2%A1%C2%BD%C2%B5x%C3%A3%C2%B1IA%C3%89%C2%8C%C3%B8ik%C3%A1%04%C2%A5%C2%8D%C2%B8%C2%A7%C3%BC%C2%84%C3%8Ds%C2%A7%1C%C3%89%C2%8BUy%C2%A8KQ%C3%B1j%C3%A0%C3%AE%5C%C3%94%C3%89%2B%7B3%C2%BB%00%00%00%C3%BF%C3%BFlYKN%C3%830%10%C2%8DS%C2%9B8%C2%8E%C2%B3d%C2%81%C2%84XQ%C3%8A9%10%12%07%C3%A0%10p%08%0E%C3%85%C2%AA%C2%A2%C3%87%60%C3%87%06%C2%A1%C2%96%25b%C2%81%C2%94%C2%8F%C3%A7%C3%97%C2%A0%C2%89RT%C2%AAzgkf%3C%C3%8F%1A%7B%3CoL%5D%C3%97%C2%AF%1A%C3%8D%C3%96%1E%2F%5B%10%11%C2%98%C3%B9%2B%C2%84p~(%C2%B7%3FGDb%C3%A6%C2%8F%10%C3%82%C2%9C%C2%99%C2%8D%3EA%22%C3%921%C3%B3g%08%C3%A1j%C2%97L%11%C2%B1'%C2%A2uQ%14%0Bk%C3%AD%C2%B8FD%3D%22%C2%AE%C2%AB%C2%AAZ%C2%88%C2%88%C3%91%C3%BCOD%09%117UU%5D%C2%A4%C2%94%C2%A0(%C2%8A%C3%AD%C3%B4%09R%C3%92Y7%C3%8DE%24%C3%97%03%01%C2%80%C2%B7%18%C3%A3%C2%A5%C2%88%C2%9C%C2%A8.3CJ%C3%A9%3D%C3%86x%C2%9D%C2%8Dt%C3%8C%C3%A8%2B%C3%B6%7D%7F%3F%0C%C3%83%C3%A6%0F%C2%BC1%C3%B3%C2%B2%2CGN%C3%B3%10%C3%BF%1E6n%C2%9Af%C3%A9%C2%BD%C2%BF%C2%B3%C3%96%C2%8E%C2%847%00%7C%23%C3%A2%C3%AD%C2%A0%C3%8D%C2%82%C2%BDa%C2%8C9%C3%B3%C3%9E%3F%3B%C3%A7%C3%86Z%12%11%7F%00%40%C3%A5%C3%BE%05%C2%9A1%C3%A6%C3%94%7B%C2%BF%C3%8A%C3%B3%7C6%C2%95Z%C3%87%C3%B6%C2%95%C2%B6m_%C2%9Cs7%C3%8E%C2%B9-%00%C2%806%C2%8A%261%C2%B5%3F%C3%93%0B%C2%A8%C3%BA%5D%C3%97%C2%AD%C2%98%C3%B9i%C2%B2%C3%BDP%C3%97%C3%B5%C3%A3%0E7%11u)%25%C3%B5%C2%A1%C3%8D%C2%B2%2C%C3%BB%05%00%00%C3%BF%C3%BF%03%00'0%19%C2%9D%C3%99%23%14%C2%A7%00%00%00%00IEND%C2%AEB%60%C2%82"; 
var icon = borderGroup.add("image", undefined, File.decode(icon_imgString)); 
var closeButton = borderGroup.add("statictext", undefined, "❌");
closeButton.graphics.foregroundColor = closeButton.graphics.newPen(closeButton.graphics.PenType.SOLID_COLOR, [0.176, 0.549, 0.922], 1);
closeButton.addEventListener("mouseover", function() {
    closeButton.graphics.foregroundColor = closeButton.graphics.newPen(closeButton.graphics.PenType.SOLID_COLOR, [0.694, 0.694, 0.694], 1);
});
closeButton.addEventListener("mouseout", function() {
    closeButton.graphics.foregroundColor = closeButton.graphics.newPen(closeButton.graphics.PenType.SOLID_COLOR, [0.176, 0.549, 0.922], 1);
});
closeButton.addEventListener("click", function() {
    myWindow.close();
});
var searchBox = myWindow.add("edittext", undefined);
searchBox.alignment = ["fill", "top"];
searchBox.preferredSize.width = 150;
searchBox.active = true;
var listBox = myWindow.add("listbox", undefined, []);
listBox.alignment = ["fill", "fill"];
var effectList = [];
myWindow.show();
searchBox.active = true;
searchEffect();
var selectedEffectIndex = -1;

var menuCommandData;
var base64EncodedData = 'UXVpdA0KTmV3IFByb2plY3QNCk9wZW4gUHJvamVjdA0KQ2xvc2UNClNhdmUNClNhdmUgQXMNClJldmVydA0KVW5kbw0KQ3V0DQpDb3B5DQpQYXN0ZQ0KQ2xlYXINClNlbGVjdCBBbGwNCkNvcHkgRXhwcmVzc2lvbiBPbmx5DQpBYm91dCBBZnRlciBFZmZlY3RzDQpOZXcgQ29tcG9zaXRpb24NCkZpbGUNCkRlc2VsZWN0IEFsbA0KQWRkIEZvb3RhZ2V0byBDb21wDQpDb21wb3NpdGlvbiBTZXR0aW5ncw0KUmVuYW1lIExheWVyDQpTZXQgUG9zdGVyIFRpbWUNCk1vdmUgVG8gVG9wDQpNb3ZlIFRvIEJvdHRvbQ0KTW92ZSBVcA0KTW92ZSBEb3duDQpUcmFuc2Zvcm0NCkxheWVyIFNldHRpbmdzDQpUaW1lIFN0cmV0Y2gNClAgSSBDIFQNClJlZG8NClJlc29sdXRpb24NClNvbGlkDQpNYXNrDQpRdWFsaXR5DQpXaXJlZnJhbWUNCkRyYWZ0DQpCZXN0DQpRdWFydGVyDQpIYWxmDQpGdWxsDQpDdXN0b20NCkZyZWUgVHJhbnNmb3JtIFBvaW50cw0KSW52ZXJ0ZWQNClN3aXRjaGVzDQpIaWRlIE90aGVyIFZpZGVvDQpTaG93IEFsbCBWaWRlbw0KQXVkaW8NClZpZGVvDQpFZmZlY3QNClBvc2l0aW9uDQpTY2FsZQ0KTWFzayBTaGFwZQ0KTWFzayBGZWF0aGVyDQpPcGFjaXR5DQpQcmVjb21wb3NlDQpSZW1vdmUgQWxsDQpBYm91dA0KR290byBUaW1lDQpNYWluDQpGaWxlDQpQcmVmZXJlbmNlcw0KRHVwbGljYXRlDQpUaGlyZA0KWm9vbSBJbg0KWm9vbSBPdXQNCjENCkludGVycHJldCBGb290YWdlDQpQcm94eQ0KRmlsZQ0KSW1wb3J0DQpTZXQgUHJveHkNCkNvbnNvbGlkYXRlIEFsbCBGb290YWdlDQpSZW1vdmUgVW51c2VkIEZvb3RhZ2UNClNoeQ0KTG9jaw0KTW90aW9uIEJsdXINCkZpbGUNCk5vbmUNClNhdmUgUHJldmlldw0KUHJldmlldw0KVGltZSBSZXZlcnNlIExheWVyDQpOZXcgRm9sZGVyDQpFZGl0IE9yaWdpbmFsDQpSZW5kZXIgU2V0dGluZ3MNCk91dHB1dCBNb2R1bGUNCkVuYWJsZSBUaW1lIFJlbWFwcGluZw0KQWRkIE91dHB1dCBNb2R1bGUNCkN1c3RvbQ0KRml0dG8gQ29tcA0KQWRkIE1hcmtlcg0KRHVwbGljYXRlIFByZXNlcnZlIEZpbGUNCktleWZyYW1lIEFzc2lzdGFudA0KQ29sbGFwc2UNCkFkZHRvIFJlbmRlciBRdWV1ZQ0KQmxlbmRpbmcgTW9kZQ0KRWZmZWN0IENvbnRyb2xzDQpBdXRvIE9yaWVudA0KU2F2ZWEgQ29weQ0KTm9ybWFsDQpEaXNzb2x2ZQ0KRGFuY2luZyBEaXNzb2x2ZQ0KQWRkDQpNdWx0aXBseQ0KU2NyZWVuDQpPdmVybGF5DQpTb2Z0IExpZ2h0DQpIYXJkIExpZ2h0DQpDbGFzc2ljIENvbG9yIERvZGdlDQpDbGFzc2ljIENvbG9yIEJ1cm4NCkRhcmtlbg0KTGlnaHRlbg0KQ2xhc3NpYyBEaWZmZXJlbmNlDQpFeGNsdXNpb24NCkh1ZQ0KU2F0dXJhdGlvbg0KQ29sb3INCkx1bWlub3NpdHkNClN0ZW5jaWwgQWxwaGENClN0ZW5jaWwgTHVtYQ0KU2lsaG91ZXR0ZSBBbHBoYQ0KU2lsaG91ZXR0ZSBMdW1hDQpQcmVzZXJ2ZSBUcmFuc3BhcmVuY3kNCk5vIFRyYWNrIE1hdHRlDQpBbHBoYSBNYXR0ZQ0KQWxwaGEgSW52ZXJ0ZWQgTWF0dGUNCkx1bWEgTWF0dGUNCkx1bWEgSW52ZXJ0ZWQgTWF0dGUNCkx1bWluZXNjZW50IFByZW11bA0KQWxwaGEgQWRkDQpEaWZmZXJlbmNlDQpDb2xvciBEb2RnZQ0KQ29sb3IgQnVybg0KTGluZWFyIERvZGdlDQpMaW5lYXIgQnVybg0KTGluZWFyIExpZ2h0DQpWaXZpZCBMaWdodA0KUGluIExpZ2h0DQpIYXJkIE1peA0KTGlnaHRlciBDb2xvcg0KRGFya2VyIENvbG9yDQpTdWJ0cmFjdA0KRGl2aWRlDQpUb2dnbGUgSG9sZCBLZXlmcmFtZQ0KS2V5ZnJhbWUgSW50ZXJwb2xhdGlvbg0KS2V5ZnJhbWUgVmVsb2NpdHkNClNhdmUgRnJhbWUgQXMNCk11bHRpcGxlIEZpbGVzDQpSZXBsYWNlIEZvb3RhZ2UNCkVkaXQgVmFsdWUNCktleWZyYW1lIFZhbHVlDQpVbmxvY2sgQWxsIExheWVycw0KUmVtZW1iZXIgSW50ZXJwcmV0YXRpb24NCkFwcGx5IEludGVycHJldGF0aW9uDQpSZWxvYWQgRm9vdGFnZQ0KQ29tcCBGbG93Y2hhcnQgVmlldw0KQWRqdXN0bWVudCBMYXllcg0KTmV3DQpUZW1wbGF0ZXMNClRyYWNrIE1hdHRlDQpTaG93IEd1aWRlcw0KTG9jayBHdWlkZXMNCkNsZWFyIEd1aWRlcw0KU2hvdyBHcmlkDQpTbmFwdG8gR3JpZA0KQWRqdXN0bWVudCBMYXllcg0KU2hvdyBSdWxlcnMNCkltcG9ydCBSZWNlbnQgRm9vdGFnZQ0KT3BlbiBSZWNlbnQgUHJvamVjdHMNClNuYXB0byBHdWlkZXMNCkZyYW1lIEJsZW5kaW5nDQpPZmYNCkZyYW1lIE1peA0KUGl4ZWwgTW90aW9uDQpSZWNlbnQgRm9vdGFnZSBMaXN0DQpSZWNlbnQgUHJvamVjdCBMaXN0DQpOb25lDQpMYWJlbA0KR2VuZXJhbA0KVHJpbSBDb21wdG8gV29yayBBcmVhDQpEaXNwbGF5DQpJbXBvcnQNCk91dHB1dA0KR3JpZHMgR3VpZGVzDQpMYWJlbHMNCk5ldyBNYXNrDQpSZW1vdmUgTWFzaw0KUmVtb3ZlIEFsbCBNYXNrcw0KUHVyZ2UNClVuZG8NCkltYWdlIENhY2hlcw0KQWxsDQpDbG9zZWQNClJldmVhbCBQcm9wZXJ0aWVzIFdpdGggS2V5ZnJhbWVzDQpBdWRpbw0KU2hvdyBMYXllciBDb250cm9scw0KU2VsZWN0IExhYmVsIEdyb3VwDQpEaXNrIENhY2hpbmcNCk1vZGUNCk5vbmUNCkFkZA0KU3VidHJhY3QNCkludGVyc2VjdA0KTGlnaHRlbg0KRGFya2VuDQpEaWZmZXJlbmNlDQpSZXNldCBNYXNrDQpBcHBseSBBbmltYXRpb24gUHJlc2V0DQpSZWNlbnQgQW5pbWF0aW9uIFByZXNldHMNCkxhc3QgRWZmZWN0DQpNYXNrIE9wYWNpdHkNCkxvY2tlZA0KTG9jayBPdGhlciBNYXNrcw0KVW5sb2NrIEFsbCBNYXNrcw0KV2F0Y2ggRm9sZGVyDQpSZWNlbnQgRmF2b3JpdGVzIExpc3QNClNuYXBzaG90DQpDb2xsZWN0IEZpbGVzDQpFeHBvcnQNClJldmVhbCBMYXllciBTb3VyY2VpbiBQcm9qZWN0DQpBZGQgS2V5ZnJhbWUNClByZXZpb3VzIEtleWZyYW1lDQpOZXh0IEtleWZyYW1lDQpSZXNldA0KUmV2ZWFsIExheWVyaW4gUHJvamVjdCBGbG93Y2hhcnQgVmlldw0KT3BlbiBMYXllciBTb3VyY2UgV2luZG93DQpIaWRlIExvY2tlZCBNYXNrcw0KUmV2ZWFsaW4gVGltZWxpbmUNCkRlbGV0ZSBUaGlzIE1hcmtlcg0KRGVsZXRlIEFsbCBNYXJrZXJzDQpVcGRhdGUgTWFya2VycyBGcm9tIFNvdXJjZQ0KMyBEIExheWVyDQpBZG9iZSBEeW5hbWljIExpbmsNCk5ldyBQcmVtaWVyZSBQcm8gU2VxdWVuY2UNCkltcG9ydCBQcmVtaWVyZSBQcm8gU2VxdWVuY2UNClNodXR0ZXIxODAgUGhhc2UwDQpTaHV0dGVyMzYwIFBoYXNlMA0KU2h1dHRlcjkwIFBoYXNlMA0KU2h1dHRlcjE4MCBQaGFzZTE4MA0KU2h1dHRlcjcyMCBQaGFzZTM2MA0KTGlnaHQNCkNhbWVyYQ0KTG9jayBNYXJrZXJzDQpTb2xvDQpTZXR0aW5ncw0KVHJhY2syIEQgTW90aW9uDQpSZXNldA0KTmV3DQpGaW5kDQpQcm9qZWN0IFNldHRpbmdzDQpMaWZ0IFdvcmsgQXJlYQ0KRXh0cmFjdCBXb3JrIEFyZWENCk9yaWVudGF0aW9uDQpBc3NpZ24zIEQgVmlldyBTaG9ydGN1dA0KU3dpdGNoMyBEIFZpZXcNCkENCkINCkMNCkVkaXQgVmFsdWUNClJlc2V0MyBEIFZpZXcNClRyYWNrdGhpcyBQcm9wZXJ0eQ0KRWRpdCBQcm9wZXJ0aWVzDQpDcmVhdGUgQ2FtZXJhIEZyb20zIEQgVmlldw0KUmVzZXQzIEQgVmlldw0KUmVzZXQzIEQgVmlldw0KQ3JlYXRlIENhbWVyYSBGcm9tMyBEIFZpZXcNClN3aXRjaCBWaWV3IExheW91dA0KMSBVcA0KMiBVcA0KMyBVcA0KU2hhcmUgVmlldyBPcHRpb25zDQpTZXQgS2V5ZnJhbWUNCkFkZCBFeHByZXNzaW9uDQpTd2l0Y2h0byBMYXN0MyBEIFZpZXcNClZpZGVvIFByZXZpZXcNClByZXZpZXdzDQpBY3RpdmUgQ2FtZXJhDQpGcm9udA0KTGVmdA0KVG9wDQpCYWNrDQpSaWdodA0KQm90dG9tDQpDdXN0b20gVmlldzENCkN1c3RvbSBWaWV3Mg0KQ3VzdG9tIFZpZXczDQpSZXZlYWwgRXhwcmVzc2lvbiBFcnJvcnMNCkZpdHRvIENvbXAgV2lkdGgNCkZpdHRvIENvbXAgSGVpZ2h0DQpSZWR1Y2UgUHJvamVjdA0KTWFzayBFeHBhbnNpb24NCldvcmtzcGFjZQ0KU2F2ZSBXb3Jrc3BhY2UNCk51bGwgT2JqZWN0DQpTZXQgRmlyc3QgVmVydGV4DQpDdXN0b20NClJldmVhbCBBbGwgTW9kaWZpZWQgUHJvcGVydGllcw0KVmlldyBPcHRpb25zDQpDcmVhdGUgUHJveHkNClN0aWxsDQpNb3ZpZQ0KUHJlcmVuZGVyDQpOZXh0IEJsZW5kaW5nIE1vZGUNClByZXZpb3VzIEJsZW5kaW5nIE1vZGUNClJvdGF0aW9uDQpNb3Rpb24gQmx1cg0KU2FtZSBBcyBMYXllcg0KT24NCk9mZg0KT25lIENvbXAgVmlldw0KVHdvIENvbXAgVmlld3MNCkZvdXIgQ29tcCBWaWV3cw0KTG9va2F0IFNlbGVjdGVkIExheWVycw0KTG9va2F0IEFsbCBMYXllcnMNClRleHQNCkNyZWF0ZSBPdXRsaW5lIE1hc2tzDQpTZWxlY3QgRXF1YWwgS2V5ZnJhbWVzDQpIaXN0b3J5DQpDcm9wIENvbXB0byBSZWdpb25vZiBJbnRlcmVzdA0KU2hvdyBUZXh0IFBhbmVscw0KUHJvcGVydHkNClNlbGVjdG9yDQpEZWxldGUgQnJ1c2gNCkFuY2hvciBQb2ludA0KUG9zaXRpb24NClNjYWxlDQpTa2V3DQpSb3RhdGlvbg0KU3Ryb2tlIFdpZHRoDQpUcmFja2luZw0KTGluZSBBbmNob3INCkNoYXJhY3RlciBPZmZzZXQNCkNoYXJhY3RlciBWYWx1ZQ0KUiBHIEINCkh1ZQ0KU2F0dXJhdGlvbg0KQnJpZ2h0bmVzcw0KT3BhY2l0eQ0KUiBHIEINCkh1ZQ0KU2F0dXJhdGlvbg0KQnJpZ2h0bmVzcw0KT3BhY2l0eQ0KRmlsbCBDb2xvcg0KU3Ryb2tlIENvbG9yDQpXaWdnbHkNCk9wYWNpdHkNCkxpbmUgU3BhY2luZw0KQXV0b3RyYWNlDQpBbGwgVHJhbnNmb3JtIFByb3BlcnRpZXMNClJvdG8gQmV6aWVyDQpSZW1vdmUgQWxsIFRleHQgQW5pbWF0b3JzDQpFeHByZXNzaW9uDQpDb252ZXJ0IFNoYXBlDQpIb3Jpem9udGFsDQpWZXJ0aWNhbA0KV2l0aCBMYXllcmVkIENvbXANClVzZXIgSW50ZXJmYWNlIENvbG9ycw0KU2VsZWN0IFByZXZpb3VzIEtleWZyYW1lcw0KU2VsZWN0IEZvbGxvd2luZyBLZXlmcmFtZXMNClNhdmUgQW5pbWF0aW9uIFByZXNldA0KR3VpZGUgTGF5ZXINCkluY3JlbWVudGFuZCBTYXZlDQpBdXRvIFNhdmUNCk1lbW9yeSBNdWx0aXByb2Nlc3NpbmcNCkF1ZGlvIEhhcmR3YXJlDQpBdWRpbyBPdXRwdXQgTWFwcGluZw0KTmV3IFByb2plY3QNClR5cGUNClNjcmlwdHMgRXhwcmVzc2lvbnMNCkNhbWVyYTMgRA0KTm90aWZpY2F0aW9ucw0KQWRvYmUgUGhvdG9zaG9wIEZpbGUNCkFkb2JlIFBob3Rvc2hvcCBGaWxlDQpSb3ZlIEFjcm9zcyBUaW1lDQpDbG9zZSBQcm9qZWN0DQpUaW1lDQpOZXcgV29ya3NwYWNlDQpSZXNldCBXb3Jrc3BhY2UNCkJyb3dzZQ0KUmV2ZWFsaW4gQnJpZGdlDQpCcm93c2UgUHJlc2V0cw0KRnJlZXplIEZyYW1lDQpSZXZlYWwgQ29tcCBJbiBQIFcNCkVkaXRpbiBBZG9iZSBBdWRpdGlvbg0KQmx1cg0KTmV3IFZpZXdlcg0KU2ltdWxhdGUgT3V0cHV0DQpVc2UgRGlzcGxheSBDb2xvciBNYW5hZ2VtZW50DQpObyBPdXRwdXQgU2ltdWxhdGlvbg0KS29kYWs1MjE4dG8gS29kYWsyMzgzDQpBc3NpZ24gV29ya3NwYWNlIFNob3J0Y3V0DQpBDQpCDQpDDQpPcGVuIEVmZmVjdCBDb250cm9scw0KU2hhcGUgTGF5ZXINCkVuYWJsZSBQZXJjaGFyYWN0ZXIzIEQNCkxheWVyIFN0eWxlcw0KTWFza2FuZCBTaGFwZSBQYXRoDQpIIEQgVCBWIFJlYzcwOQ0KUyBEIFQgViBOIFQgUyBDDQpTIEQgVCBWIFAgQSBMDQpNYWNpbnRvc2ggUiBHIEINCldpbmRvd3MgUiBHIEINCk15IEN1c3RvbSBSIEcgQg0KQ3VzdG9tDQpTZXBhcmF0ZSBEaW1lbnNpb25zDQpGbGlwIEhvcml6b250YWwNCkZsaXAgVmVydGljYWwNCkNyZWF0ZSBPdXRsaW5lIFNoYXBlDQpPcGVuIExheWVyIFdpbmRvdw0KU2F2ZSBBcyBYIE0gTA0KVXBncmFkZSBQcm9qZWN0IFAgQSBScyBUbyBDIFM0DQpPcGVuIE1pbmkgRmxvdyBQb3B1cA0KQXJyYW5nZQ0KQ29udmVydCBUbyBFZGl0YWJsZQ0KQWRkIFRvIEEgTSBFIFJlbmRlciBRdWV1ZQ0KVSBDIEZ0byBLb2RhazIzODMNCkNlbnRlciBJbiBWaWV3DQpTYXZlIEFzDQpDYW1lcmENCkVudmlyb24gTGF5ZXINCkNyZWF0ZSBGb290YWdlIE91dGxpbmVzDQpUcmFjazMgRCBDYW1lcmEgTW90aW9uDQpBZGR0byBSZW5kZXIgUXVldWUNCldhcnAgU3RhYmlsaXplcg0KRmVhdGhlciBGYWxsb2ZmDQpTbW9vdGgNCkxpbmVhcg0KRmVhdGhlciBIb2xkDQpGZWF0aGVyIEVkaXQgVGVuc2lvbg0KRmVhdGhlciBFZGl0IEV4dGVudA0KR28gVG8gS2V5ZnJhbWUgVGltZQ0KQ2luZW1hNCBEIEZpbGUNClJldmVhbCBQcm9wZXJ0aWVzIFdpdGggQW5pbWF0aW9uDQpFbmFibGUgQXV0byBTdG9wd2F0Y2gNCkV4dGVuc2lvbnMNCkFkZCBGb250cyBGcm9tIEFkb2JlDQpGaW5kIEV4dGVuc2lvbnMNCkltcG9ydCBDIEMgTGlicmFyaWVzDQpFZGl0IFdvcmtzcGFjZQ0KRnJlZXplIE9uIExhc3QgRnJhbWUNCkNyZWF0ZSBEYXRhIEZvb3RhZ2UgTGF5ZXIgS2V5ZnJhbWVzDQpBZGQgUHJvcCBUbyBDYXBzdWxlcw0KUmV2ZWFsDQpDcmVhdGUNClRyYWNrIEFuZCBTdGFiaWxpemUNCk9wZW4NCkMgQSBGaWxsIExheWVyDQpUYWZmeSBUaW1lIEhlaXINCkNyZWF0ZSBJbnRybw0KQ3JlYXRlIE91dHJvDQpDcmVhdGUgUHJvdGVjdGVkIFJlZ2lvbg0KRW5hYmxlIFByb3RlY3RlZCBSZWdpb24NCkltcG9ydCBHdWlkZXMNCkV4cG9ydCBHdWlkZXMNCk5leHQgS2V5ZnJhbWUNCkVkaXQgRXhwcmVzc2lvbg0KS2V5ZnJhbWUgU2VsZWN0IExhYmVsIEdyb3VwDQpPbiBTZWxlY3RlZCBMYXllcnMNCk9uIEFsbCBMYXllcnMNCkFsbCBNZW1vcnkgRGlzayBDYWNoZQ0KQWRkIFRvIEEgTSBFIFJlbmRlciBRdWV1ZQ0KQmlsaW5lYXINCkJpY3ViaWMNClVzZXIgUHJvZmlsZQ0KVXNlciBQcm9maWxlDQpDb3B5DQpUcmFjayBNYXNrDQpDZW50ZXIgQW5jaG9yDQpDb3B5DQpQbGF5IFByZXZpZXcNCkxpY2Vuc2UgRm9vdGFnZQ0KSyBTIFYNCkVuYWJsZSBFeHByZXNzaW9ucw0KRGlzYWJsZSBFeHByZXNzaW9ucw0KR2VuZXJhdGUgTGF5ZXIgTWFya2VycyBGcm9tIEF1ZGlvIEJlYXRzDQpHZW5lcmF0ZSBMYXllciBNYXJrZXJzIEZyb20gQXVkaW8gRXZlbnRzDQpTeW5jIFByb3BlcnR5IFRvIEF1ZGlvIEJlYXRzDQpEZWZhdWx0DQpQbGF5IFByZXZpZXc=';

function decodeFromBase64(encodedText) {
  return atob(encodedText);
}

try {
  menuCommandData = decodeFromBase64(base64EncodedData).split('\n');
} catch (e) {
}

function executeCommand(commandName) {
  try {
    var commandID = app.findMenuCommandId(commandName);
    if (commandID !== 0) {
      app.executeCommand(commandID);
    } else {
      alert("Command not found: " + commandName);
    }
  } catch (e) {
    alert("Error executing command: " + e.toString());
  }
}

function populateListBox() {
  for (var i = 0; i < menuCommandData.length; i++) {
    listBox.add("item", menuCommandData[i]);
  }
}

function searchEffect() {
    var searchQuery = searchBox.text;
    var effects = app.effects;
    listBox.removeAll();
    effectList = [];
    for (var i = 0; i < menuCommandData.length; i++) {
        var commandName = menuCommandData[i];
        if (
            searchQuery === "" ||
            commandName.toLowerCase().indexOf(searchQuery.toLowerCase()) !== -1 ||
            searchQuery === "⌕"
        ) {
            listBox.add("item", commandName);
            effectList.push(commandName);
        }
    }
    for (var i = 1; i <= effects.length; i++) {
        var effect = effects[i];
        if (effect) {
            var effectName = effect.displayName;
            if (
                searchQuery === "" ||
                effectName.toLowerCase().indexOf(searchQuery.toLowerCase()) !== -1 ||
                searchQuery === "⌕"
            ) {
                listBox.add("item", effectName);
                effectList.push(effect);
            }
        }
    }
}

function applyEffectToLayer() {
    var selectedLayer = app.project.activeItem.selectedLayers[0];
    if (selectedEffectIndex !== -1 && selectedLayer) {
        var selectedEffect = effectList[selectedEffectIndex];
        var effectMatchName = selectedEffect.matchName;
        var effectProperty = selectedLayer.property("ADBE Effect Parade").addProperty(effectMatchName);
        effectProperty.name = selectedEffect.displayName;
        myWindow.close();
    }
}

searchBox.onChanging = function() {
    searchEffect();
};

listBox.onChange = function() {
    var selectedIndex = listBox.selection.index;
    var selectedCommandName = listBox.items[selectedIndex].text;
    if (selectedIndex < menuCommandData.length) {
        executeCommand(selectedCommandName);
        myWindow.close();
    } else {
        selectedEffectIndex = selectedIndex - menuCommandData.length;
        applyEffectToLayer();
        myWindow.close();
    }
};

searchBox.onActivate = function() {
    if (searchBox.text === "⌕") {
        searchBox.text = "";
        searchEffect();
    }
};

searchBox.onDeactivate = function() {
    if (searchBox.text === "") {
        searchBox.text = "⌕";
        searchEffect();
    }
};

myWindow.addEventListener("keydown", function(event) {
    var keyCode = event.keyName;
    if (keyCode === "Down") {
        if (searchBox.text === "") {
            searchBox.text = "⌕";
            searchEffect();
        }
        listBox.active = true;
    } else if (keyCode === "Up") {
        if (listBox.selection.index === 0) {
            searchBox.active = true;
        }
    } else if (keyCode === "Enter") {
        applyEffectToLayer();
    }
    event.stopPropagation();
});

listBox.onDoubleClick = function() {
    applyEffectToLayer();
};

populateListBox();
